<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Smart Currency Converter — Divine ✨</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Divine Converter">
<link rel="apple-touch-icon" href="https://i.imgur.com/jG2tGJm.png">
<!-- 🌟 App manifest (kept inside HTML for SoloLearn) -->
<script type="application/json" id="manifestData">
{
  "name": "Smart Currency Converter — Divine ✨",
  "short_name": "Divine Converter",
  "start_url": "index.html",
  "display": "standalone",
  "background_color": "#0f2027",
  "theme_color": "#0072ff",
  "icons": [
    {
      "src": "https://iili.io/KeP0zLG.jpg",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
</script>
<meta name="theme-color" content="#0072ff">
<!-- 🌟 End of manifest setup -->

<style>
</script>
<meta name="theme-color" content="#0072ff">
<style>
<style><link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0072ff"></style>
<!-- ✅ Manifest (for app install) -->
<link rel="manifest" href="manifest.json">
<style>
  :root {
    --glass: rgba(255, 255, 255, 0.12);
  }

  body {
    margin: 0;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: "Poppins", system-ui, sans-serif;
    background: linear-gradient(-45deg, #0f2027, #203a43, #2c5364, #1e3c72);
    background-size: 400% 400%;
    animation: gradientMove 15s ease infinite;
    color: #fff;
  }

  @keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .card {
    width: 340px;
    padding: 28px;
    border-radius: 14px;
    background: var(--glass);
    backdrop-filter: blur(12px);
    box-shadow: 0 6px 30px rgba(0, 0, 0, 0.35);
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.2);
    animation: cardFade 1s ease-in-out;
  }

  @keyframes cardFade {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
  }

  h1 {
    margin: 0 0 12px;
    font-size: 22px;
    letter-spacing: 0.3px;
  }

  input, select {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: none;
    margin: 8px 0;
    background: rgba(255, 255, 255, 0.08);
    color: #fff;
    font-size: 15px;
    text-align: center;
    outline: none;
    transition: background 0.3s;
  }

  input:focus, select:focus {
    background: rgba(255, 255, 255, 0.15);
  }

  button {
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    border: none;
    background: linear-gradient(135deg, #0072ff, #00c6ff);
    color: #fff;
    font-weight: 600;
    font-size: 15px;
    cursor: pointer;
    margin-top: 10px;
    transition: transform 0.2s, box-shadow 0.3s;
  }

  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0, 198, 255, 0.4);
  }

  #result {
    margin-top: 14px;
    font-size: 18px;
    font-weight: 600;
    min-height: 1.2em;
    transition: transform 0.3s ease;
  }

  .tiny {
    font-size: 12px;
    opacity: 0.8;
    margin-top: 8px;
  }

  .status {
    font-size: 13px;
    color: #ffd;
    opacity: 0.95;
    margin-top: 8px;
  }

  .toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 8px;
  }

  .loading {
    color: #00c6ff;
    margin-top: 8px;
  }

  footer {
    margin-top: 15px;
    font-size: 13px;
    opacity: 0.8;
    text-align: center;
    color: #fff;
    text-shadow: 0 0 6px rgba(255, 255, 255, 0.4);
  }
  body.light {
  background: linear-gradient(135deg, #f0f0f0, #d9e4f5);
  color: #222;
}

body.light .card {
  background: rgba(255, 255, 255, 0.6);
  color: #000;
  box-shadow: 0 6px 20px rgba(0,0,0,0.1);
}

body.light input, 
body.light select {
  background: rgba(0, 0, 0, 0.05);
  color: #000;
}

body.light button {
  background: linear-gradient(135deg, #0072ff, #00c6ff);
  color: #fff;
}

body.light footer {
  color: #333;
}
</style>
</head>
<body>
  <div class="card">
    <h1>💱 Smart Converter</h1>

    <input id="amount" type="number" placeholder="Enter amount" step="any" />
    <select id="from">
      <option value="USD">USD 🇺🇸</option>
      <option value="NGN">NGN 🇳🇬</option>
      <option value="EUR">EUR 🇪🇺</option>
      <option value="GBP">GBP 🇬🇧</option>
      <option value="JPY">JPY 🇯🇵</option>
    </select>

    <select id="to">
      <option value="NGN">NGN 🇳🇬</option>
      <option value="USD">USD 🇺🇸</option>
      <option value="EUR">EUR 🇪🇺</option>
      <option value="GBP">GBP 🇬🇧</option>
      <option value="JPY">JPY 🇯🇵</option>
    </select>

    <button id="convertBtn">Convert</button>

    <div class="toggle">
  <input id="voiceToggle" type="checkbox" />
  <label for="voiceToggle">🔊 Voice ON</label>
</div>

<div class="toggle">
  <input id="themeToggle" type="checkbox" />
  <label for="themeToggle">🌗 Light Mode</label>
</div>

    <div id="loading" class="loading" style="display:none">Fetching latest rates…</div>
    <div id="result">Enter amount and tap Convert 🔄</div>
    <div id="status" class="status"></div>
    <div class="tiny">Last used values are saved automatically</div>

    <footer>Built by Divine ✨</footer>
  </div>

<script>
function waitForVoices(timeout = 2000) {
  return new Promise((resolve) => {
    const voices = speechSynthesis.getVoices();
    if (voices.length) return resolve(voices);
    let resolved = false;
    const onVoices = () => { if (!resolved) { resolved = true; resolve(speechSynthesis.getVoices()); } };
    window.speechSynthesis.onvoiceschanged = onVoices;
    setTimeout(() => { if (!resolved) { resolved = true; resolve(speechSynthesis.getVoices()); } }, timeout);
  });
}

window.addEventListener('load', () => {
  try {
    const lastFrom = localStorage.getItem('fromCurrency');
    const lastTo = localStorage.getItem('toCurrency');
    const lastAmount = localStorage.getItem('lastAmount');
    if (lastFrom) document.getElementById('from').value = lastFrom;
    if (lastTo) document.getElementById('to').value = lastTo;
    if (lastAmount) document.getElementById('amount').value = lastAmount;
  } catch (e) { console.log('localStorage error', e); }
});

document.getElementById('convertBtn').addEventListener('click', convertCurrency);

async function convertCurrency() {
  const amountEl = document.getElementById('amount');
  const from = document.getElementById('from').value;
  const to = document.getElementById('to').value;
  const voiceToggle = document.getElementById('voiceToggle').checked;
  const loading = document.getElementById('loading');
  const resultBox = document.getElementById('result');
  const status = document.getElementById('status');

  status.innerText = '';
  resultBox.innerText = '';
  loading.style.display = 'block';

  const amount = parseFloat(amountEl.value);
  if (isNaN(amount) || amount <= 0) {
    loading.style.display = 'none';
    resultBox.innerText = '⚠️ Enter a valid number';
    return;
  }

  try {
    localStorage.setItem('fromCurrency', from);
    localStorage.setItem('toCurrency', to);
    localStorage.setItem('lastAmount', amount);
  } catch(e) { console.log('localStorage write error', e); }

  const backupRates = {
    USD: { NGN: 1600, EUR: 0.93, GBP: 0.79, JPY: 150 },
    NGN: { USD: 0.00063, EUR: 0.00058, GBP: 0.00049, JPY: 0.094 },
    EUR: { USD: 1.07, NGN: 1700, GBP: 0.85, JPY: 160 },
    GBP: { USD: 1.27, NGN: 2000, EUR: 1.17, JPY: 190 },
    JPY: { USD: 0.0066, NGN: 10.5, EUR: 0.0063, GBP: 0.0053 }
  };

  let usedRate = null;
  try {
    const res = await fetch(`https://api.exchangerate.host/latest?base=${from}`, {cache: "no-store"});
    if (!res.ok) throw new Error('Network response not OK: ' + res.status);
    const data = await res.json();
    if (!data || !data.rates || typeof data.rates[to] === 'undefined') throw new Error('Invalid data');
    usedRate = data.rates[to];
    status.innerText = '✅ Live rate used';
  } catch (err) {
    status.innerText = '⚠️ Live rates unavailable — using offline rate';
    usedRate = backupRates[from]?.[to];
    if (!usedRate) {
      loading.style.display = 'none';
      resultBox.innerText = '⚠️ Conversion not available';
      return;
    }
  }

  const result = (amount * usedRate).toFixed(2);
  resultBox.innerText = `${amount} ${from} = ${result} ${to}${status.innerText.includes('offline') ? ' (Offline Rate)' : ''}`;
  loading.style.display = 'none';

  const colorMap = {
    USD: "linear-gradient(135deg,#00c6ff,#0072ff)",
    NGN: "linear-gradient(135deg,#00ff88,#009933)",
    EUR: "linear-gradient(135deg,#f5af19,#f12711)",
    GBP: "linear-gradient(135deg,#ff9a9e,#fad0c4)",
    JPY: "linear-gradient(135deg,#ffecd2,#fcb69f)"
  };
  document.body.style.background = colorMap[to] || "linear-gradient(135deg,#0072ff,#00c6ff)";

  if (voiceToggle && 'speechSynthesis' in window) {
    try {
      await waitForVoices(800);
      const voices = speechSynthesis.getVoices();
      const voice = voices.find(v => /en[-_]?/i.test(v.lang)) || voices[0];
      const msg = new SpeechSynthesisUtterance(`${amount} ${from} equals ${result} ${to}`);
      msg.voice = voice;
      msg.lang = 'en-US';
      msg.pitch = 1.05; msg.rate = 0.95;
      window.speechSynthesis.cancel();
      setTimeout(()=> window.speechSynthesis.speak(msg), 200);
      status.innerText += ' • 🔊 Spoken';
    } catch(speechErr) { status.innerText += ' • ⚠️ Speech failed'; }
  }
}
</script>

<!-- ✅ PWA Offline support -->
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js')
    .then(() => console.log('Service worker registered!'))
    .catch(err => console.log('Service worker failed:', err));
}
// 🌗 Theme toggle functionality
const themeToggle = document.getElementById('themeToggle');
const savedTheme = localStorage.getItem('theme');

if (savedTheme === 'light') {
  document.body.classList.add('light');
  themeToggle.checked = true;
}

themeToggle.addEventListener('change', () => {
  if (themeToggle.checked) {
    document.body.classList.add('light');
    localStorage.setItem('theme', 'light');
  } else {
    document.body.classList.remove('light');
    localStorage.setItem('theme', 'dark');
  }
});
</script>
</script>

<!-- 🌟 Service Worker inline setup -->
<script>
// Register the service worker (normally a separate file)
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    const swCode = `
      const CACHE_NAME = "divine-converter-cache-v1";
      const urlsToCache = ["/"];

      self.addEventListener("install", event => {
        event.waitUntil(
          caches.open(CACHE_NAME).then(cache => cache.addAll(urlsToCache))
        );
      });

      self.addEventListener("fetch", event => {
        event.respondWith(
          caches.match(event.request).then(response => {
            return response || fetch(event.request);
          })
        );
      });
    `;

    const blob = new Blob([swCode], { type: "text/javascript" });
    const swUrl = URL.createObjectURL(blob);
    navigator.serviceWorker.register(swUrl);
  });
}
</script>
<!-- 🌟 End of Service Worker -->
<script>
  // Register the Service Worker to enable offline capability
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      // IMPORTANT: The path here must include your repo name: /Divine-converter-/
      navigator.serviceWorker.register('/Divine-converter-/service-worker.js')
        .then(registration => {
          console.log('Service Worker registered successfully with scope: ', registration.scope);
        })
        .catch(error => {
          console.log('Service Worker registration failed: ', error);
        });
    });
  }
</script>
</body>
</html>
</body>
</html>
</body>
</html>